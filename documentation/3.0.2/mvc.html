<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;21.&nbsp;MVC Templates</title><link rel="stylesheet" type="text/css" href="/jersey.github.io/documentation.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Jersey 3.0.2 User Guide"><link rel="up" href="index.html" title="Jersey 3.0.2 User Guide"><link rel="prev" href="entity-filtering.html" title="Chapter&nbsp;20.&nbsp;Entity Data Filtering"><link rel="next" href="logging_chapter.html" title="Chapter&nbsp;22.&nbsp;Logging"><script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-3160303-1']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script></head><body class="contents"><div class="contents" bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;21.&nbsp;MVC Templates</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="entity-filtering.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="logging_chapter.html">Next</a></td></tr></table><hr></div><div style="float:right"><a href="https://eclipse-ee4j.github.io/jersey"><img src="https://eclipse-ee4j.github.io/jersey.github.io/images/jersey_logo.png"></a></div><small>Links:
            <a href="index.html">
                Table of Contents
            </a> | <a href="user-guide.html">
                Single HTML
            </a></small><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="mvc"></a>Chapter&nbsp;21.&nbsp;MVC Templates</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="mvc.html#d0e14885">21.1. Viewable</a></span></dt><dt><span class="section"><a href="mvc.html#d0e14930">21.2. @Template</a></span></dt><dd><dl><dt><span class="section"><a href="mvc.html#d0e14933">21.2.1. Annotating Resource methods</a></span></dt><dt><span class="section"><a href="mvc.html#d0e14989">21.2.2. Annotating Resource classes</a></span></dt></dl></dd><dt><span class="section"><a href="mvc.html#mvc.references">21.3. Absolute vs. Relative template reference</a></span></dt><dd><dl><dt><span class="section"><a href="mvc.html#d0e15085">21.3.1. Relative template reference</a></span></dt><dt><span class="section"><a href="mvc.html#d0e15129">21.3.2. Absolute template reference</a></span></dt></dl></dd><dt><span class="section"><a href="mvc.html#d0e15175">21.4. Handling errors with MVC</a></span></dt><dd><dl><dt><span class="section"><a href="mvc.html#d0e15229">21.4.1. MVC &amp; Bean Validation</a></span></dt></dl></dd><dt><span class="section"><a href="mvc.html#mvc.registration">21.5. Registration and Configuration</a></span></dt><dt><span class="section"><a href="mvc.html#d0e15359">21.6. Supported templating engines</a></span></dt><dd><dl><dt><span class="section"><a href="mvc.html#d0e15364">21.6.1. Mustache</a></span></dt><dt><span class="section"><a href="mvc.html#d0e15466">21.6.2. Freemarker</a></span></dt><dt><span class="section"><a href="mvc.html#d0e15582">21.6.3. JSP</a></span></dt></dl></dd><dt><span class="section"><a href="mvc.html#mvc.spi">21.7. Writing Custom Templating Engines</a></span></dt><dt><span class="section"><a href="mvc.html#d0e15729">21.8. Other Examples</a></span></dt></dl></div><p>
        Jersey provides an extension to support the Model-View-Controller (MVC) design pattern.
        In the context of Jersey components, the Controller from the MVC pattern corresponds to a resource class or method,
        the View to a template bound to the resource class or method, and the model to a Java object (or a Java bean) returned
        from a resource method (Controller).
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Some of the passages/examples from this chapter have been created by Paul Sandoz.
        </p></div><p>
        In Jersey 2, the base MVC API consists of two classes (<code class="literal">org.glassfish.jersey.server.mvc</code> package)
        that can be used to bind model to view (template), namely <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/Viewable.html" target="_top">Viewable</a> and <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/Template.html" target="_top">@Template</a>.
        These classes determine which approach (explicit/implicit) you would be taking when working with Jersey MVC
        templating support.
    </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e14885"></a>21.1.&nbsp;Viewable</h2></div></div></div><p>
            In this approach a resource method explicitly returns a reference to a view template and the data model to be
            used. For this purpose the <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/Viewable.html" target="_top">Viewable</a> class has been introduced in Jersey 1 and is also
            present (under a different package) in Jersey 2 and 3. A simple example of usage can be seen in
            <a class="xref" href="mvc.html#mvc.example.viewable.simple" title="Example&nbsp;21.1.&nbsp;Using Viewable in a resource class">Example&nbsp;21.1, &#8220;Using <code class="literal">Viewable</code> in a resource class&#8221;</a>.

            </p><div class="example"><a name="mvc.example.viewable.simple"></a><p class="title"><b>Example&nbsp;21.1.&nbsp;Using <code class="literal">Viewable</code> in a resource class</b></p><div class="example-contents"><pre class="&#xA;    toolbar: false;&#xA;    brush: java;&#xA;    ">package com.example;

@Path("foo")
public class Foo {

    @GET
    public Viewable get() {
        return new Viewable("index.foo", "FOO");
    }
}</pre></div></div><p><br class="example-break">
        </p><p>
            In this example, the <code class="literal">Foo</code> JAX-RS resource class is the controller and the
            <code class="literal">Viewable</code> instance encapsulates the provided data model (<code class="literal">FOO</code> string)
            and a named reference to the associated view template (<code class="literal">index.foo</code>).
        </p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Tip</h3><p>
                All HTTP methods may return <code class="literal">Viewable</code> instances. Thus a <code class="literal">POST</code> method may
                return a template reference to a template that produces a view as a result of processing an
                HTML <a class="link" href="https://eclipse-ee4j.github.io/jaxrs-api/apidocs/3.0.0/jakarta/ws/rs/core/Form.html" target="_top">Form</a>.
            </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e14930"></a>21.2.&nbsp;@Template</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e14933"></a>21.2.1.&nbsp;Annotating Resource methods</h3></div></div></div><p>
                There is no need to use <code class="literal">Viewable</code> every time you want to bind a model to a template. To
                make the resource method more readable (and to avoid verbose wrapping of a template reference and model into
                <code class="literal">Viewable</code>) you can simply annotate a resource method with <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/Template.html" target="_top">@Template</a>
                annotation. An updated example, using <code class="literal">@Template</code>, from previous section is shown in
                <a class="xref" href="mvc.html#mvc.example.template.simple" title="Example&nbsp;21.2.&nbsp;Using @Template on a resource method">Example&nbsp;21.2, &#8220;Using <code class="literal">@Template</code> on a resource method&#8221;</a> example.

                </p><div class="example"><a name="mvc.example.template.simple"></a><p class="title"><b>Example&nbsp;21.2.&nbsp;Using <code class="literal">@Template</code> on a resource method</b></p><div class="example-contents"><pre class="&#xA;    toolbar: false;&#xA;    brush: java;&#xA;    ">package com.example;

@Path("foo")
public class Foo {

    @GET
    @Template(name = "index.foo")
    public String get() {
        return "FOO";
    }
}</pre></div></div><p><br class="example-break">
            </p><p>
                In this example, the <code class="literal">Foo</code> JAX-RS resource class is still the controller as in previous
                section but the MVC model is now represented by the return value of annotated resource method.
            </p><p>
                The processing of such a method is then essentially the same as if the return type of the method was an
                instance of the <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/Viewable.html" target="_top">Viewable</a> class. If a method is annotated with
                <code class="literal">@Template</code> and is also returning a
                <code class="literal">Viewable</code> instance then the values from the
                <code class="literal">Viewable</code> instance take precedence over those defined in the annotation. Producible
                media types are for both cases, <code class="literal">Viewable</code> and <code class="literal">@Template</code>,
                determined by the method or class level <code class="literal">@Produces</code> annotation.
            </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e14989"></a>21.2.2.&nbsp;Annotating Resource classes</h3></div></div></div><p>
                A resource class can have templates implicitly associated with it via <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/Template.html" target="_top">@Template</a> annotation.
                For example, take a look at the resource class listing in <a class="xref" href="mvc.html#mvc.example.implicit.class" title="Example&nbsp;21.3.&nbsp;Using @Template on a resource class">Example&nbsp;21.3, &#8220;Using <code class="literal">@Template</code> on a resource class&#8221;</a>.

                </p><div class="example"><a name="mvc.example.implicit.class"></a><p class="title"><b>Example&nbsp;21.3.&nbsp;Using <code class="literal">@Template</code> on a resource class</b></p><div class="example-contents"><pre class="&#xA;    toolbar: false;&#xA;    brush: java;&#xA;    ">@Path("foo")
@Template
public class Foo {

    public String getFoo() {
        return "FOO";
    }
}</pre></div></div><p><br class="example-break">
            </p><p>
                The example relies on Jersey MVC conventions a lot and requires more explanation as such. First of all, you may
                have noticed that there is no resource method defined in this JAX-RS resource. Also, there is no template
                reference defined.
                In this case, since the <code class="literal">@Template</code> annotation placed on the resource class does not
                contain any information, the default relative template reference <code class="literal">index</code> will be used (for more
                on this topic see <a class="xref" href="mvc.html#mvc.references" title="21.3.&nbsp;Absolute vs. Relative template reference">Section&nbsp;21.3, &#8220;Absolute vs. Relative template reference&#8221;</a>).
                As for the missing resource methods, a default <code class="literal">@GET</code> method will be automatically generated by Jersey
                for the <code class="literal">Foo</code> resource (which is the MVC Controller now). The implementation of the generated
                resource method performs the equivalent of the following explicit resource method:

                </p><pre class="&#xA;    toolbar: false;&#xA;    brush: java;&#xA;    ">@GET
public Viewable get() {
    return new Viewable("index", this);
}</pre><p>

                You can see that the resource class serves in this case also as the model. Producible media types are determined
                based on the <code class="literal">@Produces</code> annotation declared on the resource class, if any.

                </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                        In case of "resource class"-based implicit MVC view templates, the controller is also the model. In such
                        case the template reference <code class="literal">index</code> is special, it is the template reference
                        associated with the controller instance itself.
                    </p></div><p>
            </p><p>
                In the following example, the MVC controller represented by a JAX-RS <code class="literal">@GET</code> sub-resource method,
                is also generated in the resource class annotated with <code class="literal">@Template</code>:

                </p><pre class="&#xA;    toolbar: false;&#xA;    brush: java;&#xA;    ">@GET
@Path("{implicit-view-path-parameter}")
public Viewable get(@PathParameter("{implicit-view-path-parameter}") String template) {
    return new Viewable(template, this);
}</pre><p>

                This allows Jersey to support also implicit sub-resource templates. For example, a JAX-RS resource at path
                <code class="literal">foo/bar</code> will try to use relative template reference <code class="literal">bar</code> that resolves to an
                absolute template reference <code class="literal">/com/foo/Foo/bar</code>.
            </p><p>
                In other words, a HTTP <code class="literal">GET</code> request to a <code class="literal">/foo/bar</code> would be handled by this
                auto-generated method in the <code class="literal">Foo</code> resource and would delegate the request to a registered
                template processor supports processing of the absolute template reference
                <code class="literal">/com/foo/Foo/bar</code>, where the model is still an instance of the same JAX-RS resource class
                <code class="literal">Foo</code>.
            </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mvc.references"></a>21.3.&nbsp;Absolute vs. Relative template reference</h2></div></div></div><p>
            As discussed in the previous section, both <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/Template.html" target="_top">@Template</a> and <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/Viewable.html" target="_top">Viewable</a> provide means
            to define a reference to a template. We will now discuss how these values are interpreted and how the concrete
            template is found.
        </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15085"></a>21.3.1.&nbsp;Relative template reference</h3></div></div></div><p>
                Relative reference is any path that does not start with a leading '<code class="literal">/</code>' (slash) character (i.e.
                <code class="literal">index.foo</code>). This kind of references is resolved into absolute ones by pre-pending a given value
                with a fully qualified name of the last matched resource.
            </p><p>
                Consider the <a class="xref" href="mvc.html#mvc.example.implicit.class" title="Example&nbsp;21.3.&nbsp;Using @Template on a resource class">Example&nbsp;21.3, &#8220;Using <code class="literal">@Template</code> on a resource class&#8221;</a> from the previous section,
                the template name reference <code class="literal">index</code> is a relative value that Jersey will resolve to its
                absolute template reference using a fully qualified class name of <code class="literal">Foo</code> (more on resolving
                relative template name to the absolute one can be found in the JavaDoc of <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/Viewable.html" target="_top">Viewable</a> class),
                which, in our case, is:
                </p><pre class="&#xA;    toolbar: false;&#xA;    brush: java;&#xA;    gutter: false;">"/com/foo/Foo/index"</pre><p>
            </p><p>
                Jersey will then search all the registered template processors (see <a class="xref" href="mvc.html#mvc.spi" title="21.7.&nbsp;Writing Custom Templating Engines">Section&nbsp;21.7, &#8220;Writing Custom Templating Engines&#8221;</a>) to find a template
                processor that can resolve the absolute template reference further to a "processable" template reference. If
                a template processor is found then the "processable" template is processed using the supplied data model.
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                    If none or empty template reference is provided (either in <code class="literal">Viewable</code> or via
                    <code class="literal">@Template</code>) then the <code class="literal">index</code> reference is assumed and all further
                    processing is done for this value.
                </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15129"></a>21.3.2.&nbsp;Absolute template reference</h3></div></div></div><p>
                Let's change the resource <code class="literal">GET</code> method in our <code class="literal">Foo</code> resource a little:

                </p><div class="example"><a name="mvc.example.viewable.absolutePath"></a><p class="title"><b>Example&nbsp;21.4.&nbsp;Using absolute path to template in <code class="literal">Viewable</code></b></p><div class="example-contents"><pre class="&#xA;    toolbar: false;&#xA;    brush: java;&#xA;    ">@GET
public Viewable get() {
    return new Viewable("/index", "FOO");
}</pre></div></div><p><br class="example-break">

                In this case, since the template reference begins with <code class="literal">"/"</code>, Jersey will consider the reference
                to be absolute already and will not attempt to absolutize it again. The reference will be used "as is" when
                resolving it to a "processable" template reference as described earlier.
            </p><p>
                Absolute template references start with leading '<code class="literal">/</code>' (i.e. <code class="literal">/com/example/index.foo</code>)
                character and are not further resolved (with respect to the resolving resource class) which means that the
                template is looked for at the provided path directly.
            </p><p>
                Note, however, that template processors for custom templating engines may modify (and the supported ones do)
                absolute template reference by pre-pending 'base template path' (if defined) and appending template suffix (i.e.
                <code class="literal">foo</code>) if the suffix is not provided in the reference.
            </p><p>
                For example assume that we want to use Mustache templates for our views and we have defined 'base template path'
                as <code class="literal">pages</code>. For the absolute template reference <code class="literal">/com/example/Foo/index</code> the template
                processor will transform the reference into the following path: <code class="literal">/pages/com/example/Foo/index.mustache</code>.
            </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e15175"></a>21.4.&nbsp;Handling errors with MVC</h2></div></div></div><p>
            In addition to <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/Template.html" target="_top">@Template</a> an <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/ErrorTemplate.html" target="_top">@ErrorTemplate</a> annotation has been introduced in
            Jersey 2.3 (valid for Jersey 3.x as well). The purpose of this annotation is to bind the model to an error view in
            case an exception has been raised during processing of a request. This is true for any exception thrown after the
            resource matching phase (i.e. this not only applies to JAX-RS resources but providers and even Jersey runtime as
            well). The model in this case is the thrown exception itself.
        </p><p>
            <a class="xref" href="mvc.html#mvc.example.error.simple" title="Example&nbsp;21.5.&nbsp;Using @ErrorTemplate on a resource method">Example&nbsp;21.5, &#8220;Using <code class="literal">@ErrorTemplate</code> on a resource method&#8221;</a> shows how to use <code class="literal">@ErrorTemplate</code> on a resource method.
            If all goes well with the method processing, then the <code class="literal">/short-link</code> template is used as page sent
            to the user. Otherwise if an exception is raised then the <code class="literal">/error-form</code> template is shown to the user.
        </p><div class="example"><a name="mvc.example.error.simple"></a><p class="title"><b>Example&nbsp;21.5.&nbsp;Using <code class="literal">@ErrorTemplate</code> on a resource method</b></p><div class="example-contents"><pre class="&#xA;    toolbar: false;&#xA;    brush: java;&#xA;    ">@POST
@Produces({"text/html&#8221;})
@Consumes(MediaType.APPLICATION_FORM_URLENCODED)
@Template(name = "/short-link")
@ErrorTemplate(name = "/error-form")
public ShortenedLink createLink(@FormParam("link") final String link) {
    // ...
}</pre></div></div><br class="example-break"><p>
            Note that <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/ErrorTemplate.html" target="_top">@ErrorTemplate</a> can be used on a resource class or a resource method to merely handle
            error states. There is no need to use <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/Template.html" target="_top">@Template</a> or <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/Viewable.html" target="_top">Viewable</a> with it.
        </p><p>
            The annotation is handled by custom <a class="link" href="https://eclipse-ee4j.github.io/jaxrs-api/apidocs/3.0.0/jakarta/ws/rs/ext/ExceptionMapper.html" target="_top">ExceptionMapper&lt;E extends Throwable&gt;</a> which creates an instance of
            <code class="literal">Viewable</code> that is further processed by Jersey. This exception mapper is registered automatically
            with a <code class="literal">MvcFeature</code>.
        </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15229"></a>21.4.1.&nbsp;MVC &amp; Bean Validation</h3></div></div></div><p>
                <code class="literal">@ErrorTemplate</code> can also be used with Bean Validation to display specific error pages in
                case the validation of input/output values fails for some reason. Everything works as described above except the
                model is not the thrown exception but rather a list of <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/validation/ValidationError.html" target="_top">ValidationError</a>s. This list can be iterated in
                the template and all the validation errors can be shown to the user in a desirable way.
            </p><div class="example"><a name="mvc.example.error.bv"></a><p class="title"><b>Example&nbsp;21.6.&nbsp;Using <code class="literal">@ErrorTemplate</code> with Bean Validation</b></p><div class="example-contents"><pre class="&#xA;    toolbar: false;&#xA;    brush: java;&#xA;    ">@POST
@Produces({"text/html&#8221;})
@Consumes(MediaType.APPLICATION_FORM_URLENCODED)
@Template(name = "/short-link&#8221;) @ErrorTemplate(name = "/error-form")
@Valid
public ShortenedLink createLink(@NotEmpty @FormParam("link") final String link) {
    // ...
}</pre></div></div><br class="example-break"><div class="example"><a name="mvc.example.error.bv.jsp"></a><p class="title"><b>Example&nbsp;21.7.&nbsp;Iterating through <code class="literal">ValidationError</code> in JSP</b></p><div class="example-contents"><pre class="&#xA;    toolbar: false;&#xA;    brush: xml;&#xA;    ">&lt;c:forEach items="${model}" var="error"&gt;
    ${error.message} "&lt;strong&gt;${error.invalidValue}&lt;/strong&gt;"&lt;br/&gt;
&lt;/c:forEach&gt;</pre></div></div><br class="example-break"><p>
                Support for Bean Validation in Jersey MVC Templates is provided by a <code class="literal">jersey-mvc-bean-validation</code>
                extension module. The JAX-RS <a class="link" href="https://eclipse-ee4j.github.io/jaxrs-api/apidocs/3.0.0/jakarta/ws/rs/core/Feature.html" target="_top">Feature</a> provided by this module
                (<code class="literal">MvcBeanValidationFeature</code>) has to be registered in order to use this
                functionality (see <a class="xref" href="mvc.html#mvc.registration" title="21.5.&nbsp;Registration and Configuration">Section&nbsp;21.5, &#8220;Registration and Configuration&#8221;</a>).
            </p><p>
                Maven users can find this module at coordinates

                </p><pre class="&#xA;    toolbar: false;&#xA;    brush: xml;&#xA;    ">&lt;dependency&gt;
    &lt;groupId&gt;org.glassfish.jersey.ext&lt;/groupId&gt;
    &lt;artifactId&gt;jersey-mvc-bean-validation&lt;/artifactId&gt;
    &lt;version&gt;3.0.2&lt;/version&gt;
&lt;/dependency&gt;</pre><p>

                and for non-Maven users the list of dependencies is available at <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/project-info/3.0.2/jersey/project/jersey-mvc-bean-validation/dependencies.html" target="_top">jersey-mvc-bean-validation</a>.
            </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mvc.registration"></a>21.5.&nbsp;Registration and Configuration</h2></div></div></div><p>
            To use the capabilities of Jersey MVC templating support in your JAX-RS/Jersey application you need to register
            specific JAX-RS <a class="link" href="https://eclipse-ee4j.github.io/jaxrs-api/apidocs/3.0.0/jakarta/ws/rs/core/Feature.html" target="_top">Feature</a>s provided by the MVC modules. For <code class="literal">jersey-mvc</code> module it is
            <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/MvcFeature.html" target="_top">MvcFeature</a> for others it could be, for example, <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/freemarker/FreemarkerMvcFeature.html" target="_top">FreemarkerMvcFeature</a>
            (<code class="literal">jersey-mvc-freemarker</code>).

            </p><div class="example"><a name="d0e15297"></a><p class="title"><b>Example&nbsp;21.8.&nbsp;Registering <code class="literal">MvcFeature</code></b></p><div class="example-contents"><pre class="&#xA;    toolbar: false;&#xA;    brush: java;&#xA;    ">new ResourceConfig()
    .register(org.glassfish.jersey.server.mvc.MvcFeature.class)
    // Further configuration of ResourceConfig.
    .register( ... );</pre></div></div><p><br class="example-break">

            </p><div class="example"><a name="d0e15305"></a><p class="title"><b>Example&nbsp;21.9.&nbsp;Registering <code class="literal">FreemarkerMvcFeature</code></b></p><div class="example-contents"><pre class="&#xA;    toolbar: false;&#xA;    brush: java;&#xA;    ">new ResourceConfig()
    .register(org.glassfish.jersey.server.mvc.freemarker.FreemarkerMvcFeature.class)
    // Further configuration of ResourceConfig.
    .register( ... );</pre></div></div><p><br class="example-break">

            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                    Modules that uses capabilities of the base Jersey MVC module register <code class="literal">MvcFeature</code>
                    automatically, so you don't need to register this feature explicitly in your code.
                </p></div><p>
        </p><p>
            Almost all of the MVC modules are further configurable and either contain a <code class="literal">*Properties</code>
            (e.g. <code class="literal">FreemarkerMvcProperties</code>) class describing all the available properties which could be
            set in a JAX-RS <code class="literal">Application</code> / <code class="literal">ResourceConfig</code>. Alternatively, the properties
            are listed directly in the module <code class="literal">*Feature</code> class.

            </p><div class="example"><a name="mvc.ex.rc.properties"></a><p class="title"><b>Example&nbsp;21.10.&nbsp;Setting <code class="literal">MvcFeature.TEMPLATE_BASE_PATH</code> value in <code class="literal">ResourceConfig</code></b></p><div class="example-contents"><pre class="&#xA;    toolbar: false;&#xA;    brush: java;&#xA;    ">new ResourceConfig()
    .property(MvcFeature.TEMPLATE_BASE_PATH, "templates")
    .register(MvcFeature.class)
    // Further configuration of ResourceConfig.
    .register( ... );</pre></div></div><p><br class="example-break">

            </p><div class="example"><a name="mvc.ex.web.xml.properties"></a><p class="title"><b>Example&nbsp;21.11.&nbsp;Setting <code class="literal">FreemarkerMvcProperties.TEMPLATE_BASE_PATH</code> value in <code class="literal">web.xml</code></b></p><div class="example-contents"><pre class="&#xA;    toolbar: false;&#xA;    brush: xml;&#xA;    ">&lt;servlet&gt;
    &lt;servlet-name&gt;org.glassfish.jersey.examples.freemarker.MyApplication&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.glassfish.jersey.servlet.ServletContainer&lt;/servlet-class&gt;
    &lt;init-param&gt;
        &lt;param-name&gt;jakarta.ws.rs.Application&lt;/param-name&gt;
        &lt;param-value&gt;org.glassfish.jersey.examples.freemarker.MyApplication&lt;/param-value&gt;
    &lt;/init-param&gt;
    &lt;init-param&gt;
        &lt;param-name&gt;jersey.config.server.mvc.templateBasePath.freemarker&lt;/param-name&gt;
        &lt;param-value&gt;freemarker&lt;/param-value&gt;
    &lt;/init-param&gt;
    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
&lt;/servlet&gt;</pre></div></div><p><br class="example-break">
        </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e15359"></a>21.6.&nbsp;Supported templating engines</h2></div></div></div><p>
            Jersey provides extension modules that enable support for several templating engines. This section lists all the
            supported engines and their modules as well as discusses any module-specific details.
        </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15364"></a>21.6.1.&nbsp;Mustache</h3></div></div></div><p>
                An integration module for <a class="link" href="https://github.com/spullara/mustache.java" target="_top">Mustache</a>-based
                templating engine.
            </p><p>
                Mustache template processor resolves absolute template references to processable template references represented
                as Mustache templates as follows:
            </p><div class="procedure"><a name="d0e15374"></a><p class="title"><b>Procedure&nbsp;21.1.&nbsp;Resolving Mustache template reference</b></p><ol class="procedure" type="1"><li class="step"><p>
                        if the absolute template reference does not end in <code class="literal">.mustache</code> append this suffix to the
                        reference; and
                    </p></li><li class="step"><p>
                        if <code class="literal">ServletContext.getResource</code>, <code class="literal">Class.getResource</code> or
                        <code class="literal">File.exists</code> returns a non-<code class="literal">null</code> value for the reference then
                        return the reference as the processable template reference otherwise return <code class="literal">null</code>
                        (to indicate the absolute reference has not been resolved by the Mustache template processor).
                    </p></li></ol></div><p>
                Thus the absolute template reference <code class="literal">/com/foo/Foo/index</code> would be resolved as
                <code class="literal">/com/foo/Foo/index.mustache</code>, provided there exists a
                <code class="literal">/com/foo/Foo/index.mustache</code>
                Mustache template in the application.
            </p><p>
                Available configuration properties:

                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">MustacheMvcFeature.TEMPLATE_BASE_PATH</code> -
                            <code class="literal">jersey.config.server.mvc.templateBasePath.mustache</code></p><p>The base path where Mustache templates are located.</p></li><li class="listitem"><p><code class="literal">MustacheMvcFeature.CACHE_TEMPLATES</code> -
                            <code class="literal">jersey.config.server.mvc.caching.mustache</code></p><p>Enables caching of Mustache templates to avoid multiple compilation.</p></li><li class="listitem"><p><code class="literal">MustacheMvcFeature.TEMPLATE_OBJECT_FACTORY</code> -
                            <code class="literal">jersey.config.server.mvc.factory.mustache</code></p><p>Property used to pass user-configured <code class="literal">MustacheFactory</code>.</p></li><li class="listitem"><p><code class="literal">MustacheMvcFeature.ENCODING</code> -
                            <code class="literal">jersey.config.server.mvc.encoding.mustache</code></p><p>Property used to configure a default encoding that will be used
                            if none is specified in <a class="link" href="https://eclipse-ee4j.github.io/jaxrs-api/apidocs/3.0.0/jakarta/ws/rs/Produces.html" target="_top">@Produces</a> annotation. If property is not defined
                            the UTF-8 encoding will be used as a default value.</p></li></ul></div><p>
            </p><p>
                Maven users can find this module at coordinates

                </p><pre class="&#xA;    toolbar: false;&#xA;    brush: xml;&#xA;    ">&lt;dependency&gt;
    &lt;groupId&gt;org.glassfish.jersey.ext&lt;/groupId&gt;
    &lt;artifactId&gt;jersey-mvc-mustache&lt;/artifactId&gt;
    &lt;version&gt;3.0.2&lt;/version&gt;
&lt;/dependency&gt;</pre><p>

                and for non-Maven users the list of dependencies is available at <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/project-info/3.0.2/jersey/project/jersey-mvc-mustache/dependencies.html" target="_top">jersey-mvc-mustache</a>.
            </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15466"></a>21.6.2.&nbsp;Freemarker</h3></div></div></div><p>
                An integration module for <a class="link" href="https://freemarker.apache.org/" target="_top">Freemarker</a>-based templating engine.
            </p><p>
                Freemarker template processor resolves absolute template references to processable template references represented
                as Freemarker templates as follows:
            </p><div class="procedure"><a name="d0e15476"></a><p class="title"><b>Procedure&nbsp;21.2.&nbsp;Resolving Freemarker template reference</b></p><ol class="procedure" type="1"><li class="step"><p>
                        if the absolute template reference does not end in <code class="literal">.ftl</code> append this suffix to the
                        reference; and
                    </p></li><li class="step"><p>
                        if <code class="literal">ServletContext.getResource</code>, <code class="literal">Class.getResource</code> or
                        <code class="literal">File.exists</code> returns a non-<code class="literal">null</code> value for the reference then
                        return the reference as the processable template reference otherwise return <code class="literal">null</code>
                        (to indicate the absolute reference has not been resolved by the Freemarker template processor).
                    </p></li></ol></div><p>
                Thus the absolute template reference <code class="literal">/com/foo/Foo/index</code> would be resolved to
                <code class="literal">/com/foo/Foo/index.ftl</code>, provided there exists a <code class="literal">/com/foo/Foo/index.ftl</code>
                Freemarker template in the application.
            </p><p>
                Jersey will assign the model instance to an attribute named <code class="literal">model</code>.
                So it is possible to reference the <code class="literal">foo</code> key from the provided <code class="literal">Map</code> (MVC Model)
                resource from the Freemarker template as follows:

                </p><pre class="&#xA;    toolbar: false;&#xA;    brush: xml;&#xA;    gutter: false;">&lt;h1&gt;${model.foo}&lt;/h1&gt;</pre><p>
            </p><p>
                Available configuration properties:

                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">FreemarkerMvcFeature.TEMPLATE_BASE_PATH</code> -
                            <code class="literal">jersey.config.server.mvc.templateBasePath.freemarker</code></p><p>The base path where Freemarker templates are located.</p></li><li class="listitem"><p><code class="literal">FreemarkerMvcFeature.CACHE_TEMPLATES</code> -
                            <code class="literal">jersey.config.server.mvc.caching.freemarker</code></p><p>Enables caching of Freemarker templates to avoid multiple compilation.</p></li><li class="listitem"><p><code class="literal">FreemarkerMvcFeature.TEMPLATE_OBJECT_FACTORY</code> -
                            <code class="literal">jersey.config.server.mvc.factory.freemarker</code></p><p>Property used to pass user-configured <code class="literal">FreemarkerFactory</code>.</p></li><li class="listitem"><p><code class="literal">FreemarkerMvcFeature.ENCODING</code> -
                            <code class="literal">jersey.config.server.mvc.encoding.freemarker</code></p><p>Property used to configure a default encoding that will be used
                            if none is specified in <a class="link" href="https://eclipse-ee4j.github.io/jaxrs-api/apidocs/3.0.0/jakarta/ws/rs/Produces.html" target="_top">@Produces</a> annotation. If property is not defined
                            the UTF-8 encoding will be used as a default value.</p></li></ul></div><p>
            </p><p>
                Maven users can find this module at coordinates

                </p><pre class="&#xA;    toolbar: false;&#xA;    brush: xml;&#xA;    ">&lt;dependency&gt;
    &lt;groupId&gt;org.glassfish.jersey.ext&lt;/groupId&gt;
    &lt;artifactId&gt;jersey-mvc-freemarker&lt;/artifactId&gt;
    &lt;version&gt;3.0.2&lt;/version&gt;
&lt;/dependency&gt;</pre><p>

                and for non-Maven users the list of dependencies is available at <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/project-info/3.0.2/jersey/project/jersey-mvc-freemarker/dependencies.html" target="_top">jersey-mvc-freemarker</a>.
            </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15582"></a>21.6.3.&nbsp;JSP</h3></div></div></div><p>
                An integration module for JSP-based templating engine.
            </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Limitations of Jersey JSP MVC Templates</h3><p>
                    Jersey web applications that want to use JSP templating support should be registered as Servlet
                    filters rather than Servlets in the application's <code class="literal">web.xml</code>. The
                    <code class="literal">web.xml</code>-less deployment style introduced in Servlet 3.0 is not supported at the moment
                    for web applications that require use of Jersey MVC templating support.
                </p></div><p>
                JSP template processor resolves absolute template references to processable template references represented as JSP
                pages as follows:
            </p><div class="procedure"><a name="d0e15600"></a><p class="title"><b>Procedure&nbsp;21.3.&nbsp;Resolving JSP template reference</b></p><ol class="procedure" type="1"><li class="step"><p>
                        if the absolute template reference does not end in <code class="literal">.jsp</code> append this suffix to the
                        reference; and
                    </p></li><li class="step"><p>
                        if <code class="literal">ServletContext.getResource</code> returns a non-<code class="literal">null</code> value for the reference then
                        return the reference as the processable template reference otherwise return <code class="literal">null</code>
                        (to indicate the absolute reference has not been resolved by the JSP template processor).
                    </p></li></ol></div><p>
                Thus the absolute template reference <code class="literal">/com/foo/Foo/index</code> would be resolved to
                <code class="literal">/com/foo/Foo/index.jsp</code>, provided there exists a <code class="literal">/com/foo/Foo/index.jsp</code>
                JSP page in the web application.
            </p><p>
                Jersey will assign the model instance to the attribute named <code class="literal">model</code> or <code class="literal">it</code>.
                So it is possible to reference the <code class="literal">foo</code> property on the <code class="literal">Foo</code> resource
                from the JSP template as follows:

                </p><pre class="&#xA;    toolbar: false;&#xA;    brush: xml;&#xA;    gutter: false;">&lt;h1&gt;${model.foo}&lt;/h1&gt;</pre><p>

                or

                </p><pre class="&#xA;    toolbar: false;&#xA;    brush: xml;&#xA;    gutter: false;">&lt;h1&gt;${it.foo}&lt;/h1&gt;</pre><p>
            </p><p>
                To include another JSP page in the currently processed one a custom <code class="literal">include</code> tag can be used.
                Mandatory parameter <code class="literal">page</code> represents a relative template name which would be absolutized using
                the same resolving resource class as the parent JSP page template.

                </p><div class="example"><a name="d0e15660"></a><p class="title"><b>Example&nbsp;21.12.&nbsp;Including JSP page into JSP page</b></p><div class="example-contents"><pre class="&#xA;    toolbar: false;&#xA;    brush: xml;&#xA;    ">&lt;%@page contentType="text/html"%&gt;
&lt;%@page pageEncoding="UTF-8"%&gt;

&lt;%@taglib prefix="rbt" uri="urn:org:glassfish:jersey:servlet:mvc" %&gt;

&lt;html&gt;
    &lt;body&gt;

    &lt;rbt:include page="include.jsp"/&gt;

    &lt;/body&gt;
&lt;/html&gt;</pre></div></div><p><br class="example-break">
            </p><p>
                Available configuration properties:

                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">JspMvcFeature.TEMPLATE_BASE_PATH</code> -
                            <code class="literal">jersey.config.server.mvc.templateBasePath.jsp</code></p><p>The base path where JSP templates are located.</p></li></ul></div><p>
            </p><p>
                Maven users can find this module at coordinates

                </p><pre class="&#xA;    toolbar: false;&#xA;    brush: xml;&#xA;    ">&lt;dependency&gt;
    &lt;groupId&gt;org.glassfish.jersey.ext&lt;/groupId&gt;
    &lt;artifactId&gt;jersey-mvc-jsp&lt;/artifactId&gt;
    &lt;version&gt;3.0.2&lt;/version&gt;
&lt;/dependency&gt;</pre><p>

                and for non-Maven users the list of dependencies is available at <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/project-info/3.0.2/jersey/project/jersey-mvc-jsp/dependencies.html" target="_top">jersey-mvc-jsp</a>.
            </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mvc.spi"></a>21.7.&nbsp;Writing Custom Templating Engines</h2></div></div></div><p>
            To add support for other (custom) templating engines into Jersey MVC Templating facility, you need to implement the
            <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/spi/TemplateProcessor.html" target="_top">TemplateProcessor</a> and register this class into your application.

            </p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Tip</h3><p>
                    When writing template processors it is recommend that you use an appropriate unique suffix for the
                    processable template references, in which case it is then possible to easily support mixing of multiple
                    templating engines in a single application without conflicts.
                </p></div><p>

            </p><div class="example"><a name="d0e15699"></a><p class="title"><b>Example&nbsp;21.13.&nbsp;Custom <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/spi/TemplateProcessor.html" target="_top">TemplateProcessor</a></b></p><div class="example-contents"><pre class="&#xA;    toolbar: false;&#xA;    brush: java;&#xA;    ">@Provider
class MyTemplateProcessor implements TemplateProcessor&lt;String&gt; {

    @Override
    public String resolve(String path, final MediaType mediaType) {
        final String extension = ".testp";

        if (!path.endsWith(extension)) {
            path = path + extension;
        }

        final URL u = this.getClass().getResource(path);
        return u == null ? null : path;
    }

    @Override
    public void writeTo(String templateReference,
                        Viewable viewable,
                        MediaType mediaType,
                        OutputStream out) throws IOException {
        final PrintStream ps = new PrintStream(out);
        ps.print("path=");
        ps.print(templateReference);
        ps.println();
        ps.print("model=");
        ps.print(viewable.getModel().toString());
        ps.println();
    }

}</pre></div></div><p><br class="example-break">

            </p><div class="example"><a name="d0e15707"></a><p class="title"><b>Example&nbsp;21.14.&nbsp;Registering custom <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/apidocs/3.0.2/jersey/org/glassfish/jersey/server/mvc/spi/TemplateProcessor.html" target="_top">TemplateProcessor</a></b></p><div class="example-contents"><pre class="&#xA;    toolbar: false;&#xA;    brush: java;&#xA;    ">new ResourceConfig()
    .register(MyTemplateProcessor.class)
    // Further configuration of ResourceConfig.
    .register( ... );</pre></div></div><p><br class="example-break">
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                In a typical set-up projects using the Jersey MVC templating support would depend on the base module that
                provides the API and SPI and a single templating engine module for the templating engine of your choice.
                These modules need to be mentioned explicitly in your <code class="literal">pom.xml</code> file.
            </p></div><p>
            If you want to use just templating API infrastructure provided by Jersey for the MVC templating support in order to
            implement your custom support for a templating engine other than the ones provided by Jersey,
            you will need to add the base <a class="link" href="https://eclipse-ee4j.github.io/jersey.github.io/project-info/3.0.2/jersey/project/jersey-mvc/dependencies.html" target="_top">jersey-mvc</a> module into the list of your dependencies:

            </p><pre class="&#xA;    toolbar: false;&#xA;    brush: xml;&#xA;    ">&lt;dependency&gt;
    &lt;groupId&gt;org.glassfish.jersey.ext&lt;/groupId&gt;
    &lt;artifactId&gt;jersey-mvc&lt;/artifactId&gt;
    &lt;version&gt;3.0.2&lt;/version&gt;
&lt;/dependency&gt;</pre><p>
        </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e15729"></a>21.8.&nbsp;Other Examples</h2></div></div></div><p>To see an example of MVC (JSP) templating support in Jersey refer to the
            <a class="link" href="https://github.com/eclipse-ee4j/jersey/tree/3.0.2/examples/bookstore-webapp" target="_top">MVC (Bookstore) Example</a>.</p></div></div><link href="https://eclipse-ee4j.github.io/jersey.github.io/sh/shCore.css" rel="stylesheet" type="text/css"><link href="https://eclipse-ee4j.github.io/jersey.github.io/sh/shThemeDefault.css" rel="stylesheet" type="text/css"><script src="https://eclipse-ee4j.github.io/jersey.github.io/sh/shCore.js" type="text/javascript"></script><script src="https://eclipse-ee4j.github.io/jersey.github.io/sh/shAutoloader.js" type="text/javascript"></script><script type="text/javascript">
            function path() {
              var args = arguments,
                  result = []
                  ;

              for(var i = 0; i < args.length; i++)
                  result.push(args[i].replace('@', 'https://eclipse-ee4j.github.io/jersey.github.io/sh/'));

              return result
            };

            SyntaxHighlighter.autoloader.apply(null, path(
              'applescript            @shBrushAppleScript.js',
              'actionscript3 as3      @shBrushAS3.js',
              'bash shell             @shBrushBash.js',
              'coldfusion cf          @shBrushColdFusion.js',
              'cpp c                  @shBrushCpp.js',
              'c# c-sharp csharp      @shBrushCSharp.js',
              'css                    @shBrushCss.js',
              'delphi pascal          @shBrushDelphi.js',
              'diff patch pas         @shBrushDiff.js',
              'erl erlang             @shBrushErlang.js',
              'groovy                 @shBrushGroovy.js',
              'java                   @shBrushJava.js',
              'jfx javafx             @shBrushJavaFX.js',
              'js jscript javascript  @shBrushJScript.js',
              'perl pl                @shBrushPerl.js',
              'php                    @shBrushPhp.js',
              'text plain             @shBrushPlain.js',
              'py python              @shBrushPython.js',
              'ruby rails ror rb      @shBrushRuby.js',
              'sass scss              @shBrushSass.js',
              'scala                  @shBrushScala.js',
              'sql                    @shBrushSql.js',
              'vb vbnet               @shBrushVb.js',
              'xml xhtml xslt html    @shBrushXml.js'
            ));

            SyntaxHighlighter.all();
        </script><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="entity-filtering.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="logging_chapter.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;20.&nbsp;Entity Data Filtering&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;22.&nbsp;Logging</td></tr></table></div></div></body></html>